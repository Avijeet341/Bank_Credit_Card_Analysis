{
	"name": "External_table_pointing_to_customers",
	"properties": {
		"content": {
			"query": "-- 2. External table pointing to customers.csv\nIF OBJECT_ID('external_customers','U') IS NOT NULL\n    DROP EXTERNAL TABLE external_customers;\nGO\n\nCREATE EXTERNAL TABLE external_customers\n(\n    customer_id VARCHAR(500),\n    age VARCHAR(200),\n    gender VARCHAR(200),\n    income VARCHAR(200),\n    employment_status VARCHAR(200),\n    years_employed VARCHAR(200),\n    city VARCHAR(200),\n    state VARCHAR(200)\n)\nWITH (\n    LOCATION = 'customers.csv',                   -- file name in container\n    DATA_SOURCE = bank_raw_data_adls,             -- your external data source (identifier, not quoted)\n    FILE_FORMAT = fmt_csv\n);\nGO\n\n-- 3. Insert into staging (convert later into typed final tables)\nINSERT INTO BankCredit.stg_customers\nSELECT * FROM external_customers;\nGO\n\n-- 4. Quick check\nSELECT 'stg_customers' AS table_name, COUNT(*) AS rows_loaded FROM BankCredit.stg_customers;\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "kraft100",
				"poolName": "kraft100"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}